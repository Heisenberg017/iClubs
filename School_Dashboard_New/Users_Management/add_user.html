<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="../../Club Coordinator/main.css" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous" />
    <title>Aditya Birla Public School - School Dashboard</title>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU"
        crossorigin="anonymous" />
    <script src="https://code.jquery.com/jquery-3.3.1.js " integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
        crossorigin="anonymous "></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js " integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 "
        crossorigin="anonymous "></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js " integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy "
        crossorigin="anonymous "></script>
</head>

<body style="background-color:#f0f0f0">
    <div class="page-container__new">
        <div class="sidebar-menu">
            <div class="sidebar-header">
                <div class="logo">
                    <a href="inst_dashboard.php">
                        wingxp</a>
                </div>
            </div>
            <div class="side-nav-wrapper">
                <ul class="side-nav_list">
                    <li>
                        <i class="fas fa-graduation-cap side-icons fa-fw"></i>
                        <a href="#" class="side-nav_links"> Clubs Management </a>
                    </li>
                    <li>
                        <i class="fas fa-user side-icons fa-fw"></i>
                        <a href="#" class="side-nav_links"> Users Management </a>
                    </li>
                    <li>
                        <i class="fas fa-cog side-icons fa-fw"></i>
                        <a href="#" class="side-nav_links">Settings</a>
                    </li>
                </ul>
            </div>
            <div class="footer-wrap">
                <h1 class="copy-text">
                    Copyright &copy; iClubs 2018 .All rights reserved
                </h1>
                <a href="#">Privacy Policy</a> <span>|</span> <a href="#">Feedback</a>
            </div>
        </div>
        <div class="main-content" style="min-height: 100vh;">
            <div class="right_topNav">
                <div class="inner-topNav">
                    <div class="row no-gutters ">
                        <div class="col-10">
                            <div class="icon-wrap">
                                <h1 class="topNav_first">
                                    ST. XAVIER'S HIGH SCHOOL <span> DASHBOARD </span>
                                </h1>
                            </div>
                        </div>
                        <div class="col-2">
                            <div class="icon-wrap">
                                <a href="#" class="btn_logout indigo wave">Logout</a>
                                </h1>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="new-container">
                <div id="msg" style="background-color:red;color:white;margin-left:40%; width: fit-content; padding: 20px;font-size: larger; display:none;">
                </div>
                <h1 class="page__header">Add Users</h1>

                <div class="form-wrap">
                    <div class="tabs">
                        <h3 class="tab-header">
                            <a class="active" href="#signup-tab-content">Add A Student</a>
                        </h3>
                        <h3 class="tab-header"><a href="#login-tab-content">Import</a></h3>
                    </div>

                    <div class="tabs-content">
                        <div id="signup-tab-content" class="active">
                            <form action="" id="form_manual" enctype="multipart/form-data">
                                <div class="tab-content-form">
                                    <input type="text" name="roll" placeholder="Roll No" class="tab-content-form_fields" />
                                    <input type="text" name="name" placeholder="Name" class="tab-content-form_fields" />
                                    <input type="text" name="phone" placeholder="Phone" class="tab-content-form_fields" />
                                    <input type="text" name="p_name" placeholder="Parent Name" class="tab-content-form_fields" />
                                    <input type="text" name="p_phone" placeholder="Parent Phone" class="tab-content-form_fields" />
                                    <input type="email" name="email" placeholder="Email" class="tab-content-form_fields" />
                                    <select name="class_man" id="school_class" onchange="get_batch()" required>
                                        <option value="">Choose Class</option>
                                        <option value='INST_258_5'>5</option>
                                        <option value='INST_258_4'>4</option>
                                        <option value='INST_258_3'>3</option>
                                        <option value='INST_258_2'>2</option>
                                        <option value='INST_258_1'>1</option>
                                        <option value='INST_258_6'>6</option>
                                        <option value='INST_258_7'>7</option>
                                        <option value='INST_258_8'>8</option>
                                        <option value='INST_258_9'>9</option>
                                        <option value='INST_258_10'>10</option>
                                        <option value='INST_258_11'>11</option>
                                        <option value='INST_258_12'>12</option>
                                    </select>
                                    <select name="batch" id="batch" required>
                                        <option>Select Batch</option>
                                    </select>
                                </div>
                                <button class="tab-content-form_btn" type="button" onclick="save();">
                                    <span>Submit</span>
                                </button>
                            </form>
                        </div>
                        <div id="login-tab-content">
                            <div class="tab-content">
                                <h1 class="tab-content-import_header">Download Excel Template Here</h1>
                                <a href="assets/dataprocess/sample.xlsx" download="template">Download</a>
                                <h1 class="tab-content-import_header_new" style="margin-top:10px;">Upload Excel File
                                    Here</h1>
                                <form action="" id="import" enctype="multipart/form-data">
                                    <input type="file" name="file" id="file" accept=".xls,.xlsx">
                                    <button class="tab-content-form_btn import_btn" type="button" onclick="import_fn();">
                                        <span>Import</span>
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <a href="#" class="back__link"><i class="fas fa-arrow-left"></i> Back</a>

            </div>

        </div>
        <div class="footer" style=" position: absolute;
   
    width: 100%;
    height: 60px; 
    background:#000;">
            <div class="left-footer" style="padding: 15px; padding: 15px 0;
        font-size: 20px;
        color: #fff;
        float: none;
        text-align: center;">
                &copy; Copyright â€“ iCLUBS 2018
            </div>
        </div>

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU"
            crossorigin="anonymous" />
        <script src="https://code.jquery.com/jquery-3.3.1.js " integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
            crossorigin="anonymous "></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js " integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 "
            crossorigin="anonymous "></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js " integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy "
            crossorigin="anonymous "></script>
        <script src="../assets/js/script.js"></script>
        <script>
            $(document).ready($('#class').change());
            $(document).ready($('#class_imp').change());

            function get_batch() {
                var class_v = $('#school_class').val();
                $.ajax({
                    type: 'GET',
                    url: 'get_batch.php?class=' + class_v,
                    data: '',
                    success: function (response) {
                        $('#batch').html(response);
                    }
                });
            }

            function get_batch_imp() {
                var class_v = $('#class_imp').val();
                $.ajax({
                    type: 'GET',
                    url: 'get_batch.php?class=' + class_v,
                    data: '',
                    success: function (response) {
                        $('#batch_imp').html(response);
                    }
                });
            }

            function save() {
                var roll = $('#roll').val();
                var name = $('#name').val();
                var phone = $('#phone').val();
                var p_name = $('#p_name').val();
                var p_phone = $('#p_phone').val();
                var email = $('#email').val();
                var school_class = $('#school_class').val();
                var batch = $('#batch').val();
                if (roll == '' || name == '' || phone == '' || p_name == '' || p_phone == '' ||
                    email == '' || school_class == '' || batch == '') {
                    alert('Please make sure all fields are filled.');
                    event.preventDefault();
                } else {
                    event.preventDefault();
                    var form = $('#form_manual')[0];
                    var data = new FormData(form);
                    $.ajax({
                        type: "POST",
                        enctype: 'multipart/form-data',
                        url: "add_user_back.php",
                        data: data,
                        processData: false,
                        contentType: false,
                        cache: false,
                        timeout: 600000,
                        success: function (response) {
                            console.log(response);
                            if (response == 'success') {
                                $('#msg').html('Successfully Added');
                                $('#msg').css('display', 'block');
                            } else if (response == 'error') {
                                $('#msg').html('Error in the System. Please try Later');
                                $('#msg').css('display', 'block');
                            }
                        }
                    });
                }

            }

            function import_fn() {
                var school_class = $('#class_imp').val();
                var batch = $('#batch_imp').val();
                if (school_class == '' || batch == '') {
                    alert('Please make sure all fields are filled.');
                    event.preventDefault();
                } else {
                    event.preventDefault();
                    var form = $('#import')[0];
                    var data = new FormData(form);
                    $.ajax({
                        type: "POST",
                        enctype: 'multipart/form-data',
                        url: "process.php",
                        data: data,
                        processData: false,
                        contentType: false,
                        cache: false,
                        timeout: 600000,
                        success: function (response) {
                            response.trim();
                            console.log(response);
                            if (String(response) == 'success') {
                                $('#msg').html('Successfully Imported');
                                $('#msg').css('display', 'block');
                            } else if (String(response) == 'error') {
                                $('#msg').html('Error in the System. Please Try Later');
                                $('#msg').css('display', 'block');
                            } else if (response == 'update_error') {
                                $('#msg').html(
                                    'Please use Add a Student option to add manually or Contact Admin to Add using Excel'
                                );
                                $('#msg').css('display', 'block');
                            } else if (String(response) == 'invalid_format') {
                                $('#msg').html(
                                    'Invalid Format. Please use this format <a href="http://www.wingxp.com/login/assets/dataprocess/sample.xlsx" target="_blank">Download</a>'
                                );
                                $('#msg').css('display', 'block');
                            } else {
                                console.log(response);
                            }
                        }
                    });
                }

            }
        </script>
</body>

</html>